Author: Benn Sundsrud <benn.sundsrud@gmail.com>
Description: Initialize kbdintctxt->devices_done before using it
Abstract:
 In Debian squeeze-lts, the fix for CVE-2015-5600 breaks authentication
 mechanisms that rely on the keyboard-interactive method. The patch
 CVE-2015-5600.patch introduces the field 'devices_done' to the
 KbdintAuthctxt struct, but does not initialize the field in the
 kbdint_alloc() function. On Linux, this ends up filling that field with
 junk data. The attached patch against adds the initialization of the
 `devices_done` field alongside the existing initialization code. This
 has also been reported upstream.

--- a/auth2-chall.c
+++ b/auth2-chall.c
@@ -130,6 +130,7 @@
 	debug("kbdint_alloc: devices '%s'", kbdintctxt->devices);
 	kbdintctxt->ctxt = NULL;
 	kbdintctxt->device = NULL;
+	kbdintctxt->devices_done = 0;
 	kbdintctxt->nreq = 0;
 
 	return kbdintctxt;
